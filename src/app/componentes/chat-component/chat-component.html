<!-- LOGIN SCREEN -->
<div *ngIf="!chat.username" class="login-container">
  <h2>Login</h2>
  <input [(ngModel)]="usernameInput" placeholder="Enter your name" />
  <button (click)="login()">Login</button>
</div>

<!-- MAIN CHAT APP -->
<div *ngIf="chat.username" class="chat-app">

  <!-- LEFT SIDEBAR: ROOMS -->
  <div class="sidebar">
    <h3>Rooms</h3>
    <ul>
      <li *ngFor="let r of rooms">
        <button (click)="switchRoom(r)" [class.active]="chat.currentRoom === r">{{ r }}</button>
      </li>
    </ul>
  </div>

  <!-- MAIN CHAT AREA -->
  <div class="chat-main">
    <h3>{{ chat.currentRoom || 'Select a room' }}</h3>

    <!-- ROOM MESSAGES -->
    <div class="messages-list" *ngIf="chat.currentRoom">
      <div *ngFor="let m of chat.messages[chat.currentRoom]"
        [ngClass]="m.user === chat.username ? 'my-message' : 'other-message'">
        <b>{{ m.user }}:</b> {{ m.text }}
      </div>
    </div>

    <!-- SEND MESSAGE -->
    <div class="send-section" *ngIf="chat.currentRoom">
      <input [(ngModel)]="message" placeholder="Message..." />
      <button (click)="send()">Send</button>
    </div>
  </div>

  <!-- RIGHT PANEL: ONLINE USERS -->
  <div class="users-panel">
    <h4>Online Users</h4>
    <ul>
      <li *ngFor="let u of chat.onlineUsers">
        <button (click)="startPrivateChat(u)">{{ u }}</button>
      </li>
    </ul>
  </div>

  <!-- PRIVATE CHAT PANEL -->
  <div *ngIf="activePrivateUser" class="private-chat">
    <h4>Private Chat with {{ activePrivateUser }}</h4>
    <div class="messages-list">
      <div *ngFor="let m of chat.privateMessages[activePrivateUser]" class="other-message">
        <b>{{ m.from }}:</b> {{ m.text }}
      </div>
    </div>

    <div class="send-section">
      <input [(ngModel)]="privateMessage" placeholder="Message..." />
      <button (click)="sendPm()">Send</button>
      <button (click)="activePrivateUser = ''">Close</button>
    </div>
  </div>

</div>
